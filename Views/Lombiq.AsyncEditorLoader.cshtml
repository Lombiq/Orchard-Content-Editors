@using Lombiq.ContentEditors.Constants
@using Lombiq.ContentEditors.ViewModels
@using Orchard.Services

@{
    var viewModel = Model.ViewModel as AsyncEditorLoaderViewModel;

    Script.Require(ResourceNames.Lombiq_AsyncEditor).AtHead();

    viewModel.EditUrl = string.IsNullOrEmpty(viewModel.EditorGroup)
        ? Url.Action("Edit", "AsyncEditor", new { Area = "Lombiq.ContentEditors" })
        : viewModel.EditorGroup;

    viewModel.ProcessingIndicatorElementClass = viewModel.UseStaticLoadingIndicator
        ? ".js-" + ElementNames.AsyncEditorLoader.ProcessingIndicatorElementName : string.Empty;

    viewModel.AsyncEditorLoaderId = Html.AsyncEditorPluginId(viewModel.ContentType);
}

@Display.Lombiq_AsyncEditorLoader_Container(AsyncEditorLoaderId: viewModel.AsyncEditorLoaderId)

@Html.Hidden(viewModel.AsyncEditorLoaderId + "options", WorkContext.Resolve<IJsonConverter>().Serialize(viewModel))