@{
    Script.Require(Lombiq.ContentEditors.Constants.ResourceNames.jQueryUI);
    
    var buttonShapes = Model.ButtonShapes as IEnumerable<dynamic> ?? Enumerable.Empty<dynamic>();

    const string DefaultBlockName = "modal";
    string BlockName = Model.BlockName as string ?? DefaultBlockName;
    var id = Model.Id as string ?? BlockName;

    const string ModalContainerName = DefaultBlockName + "Container";
}

@Display.Lombiq_Modal_Resources()

@Display.Lombiq_Modal_Content(
    Title: Model.Title,
    Body: Model.Body,
    BodyShape: Model.BodyShape,
    AdditionalAttributes: Model.AdditionalAttributes,
    BlockName: Model.BlockName,
    Id: Model.Id)

<script type="text/javascript">
    ; (function ($) {
        $(function () {
            $("#@id").dialog({
                dialogClass: "@ModalContainerName",
                width: "460px",
                closeOnEscape: true,
                modal: true,
                autoOpen: false,
                buttons: [
                    @foreach (var buttonShape in buttonShapes)
                    {
                        @Display(buttonShape)
                        @:,
                    }
                ],
                beforeClose: function () {
                    $(this).data("context", null);
                }
            });
        });
    })(jQuery);
</script>