@using Orchard.Utility.Extensions

@model dynamic

@{
    string startDateFieldName = Model.StartDateFieldName;
    string endDateFieldName = Model.EndDateFieldName;

    if (string.IsNullOrEmpty(startDateFieldName) || string.IsNullOrEmpty(endDateFieldName))
    {
        return;
    }
}

<script type="text/javascript">
    ; (function ($) {
        $(function () {
            var startDatePicker = $(".@(startDateFieldName.HtmlClassify())").lombiq_Editors_DateTimeEditor()[0];
            var endDatePicker = $(".@(endDateFieldName.HtmlClassify())").lombiq_Editors_DateTimeEditor()[0];

            startDatePicker.settings.dateChanged = function (startDate) {
                if (startDate) {
                    var endDate = endDatePicker.getDate();

                    if (!endDate) {
                        endDatePicker.setDate(startDate);
                    }

                    endDatePicker.setOption("minDate", startDate);
                }
            };

            endDatePicker.settings.dateChanged = function (endDate) {
                if (endDate) {
                    var startDate = startDatePicker.getDate();

                    if (!startDate) {
                        startDatePicker.setDate(endDate);
                    }
                    startDatePicker.setOption("maxDate", endDate);
                }
            };
        });
    })(jQuery);
</script>