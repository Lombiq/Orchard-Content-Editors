@using Lombiq.ContentEditors.ViewModels
@using Orchard.Utility.Extensions

@{
    var viewModel = Model.ViewModel as BoolEditorViewModel;
    var value = (viewModel.Value as bool?) ?? false;

    const string DefaultBlockName = "BoolEditor";
    string BlockName = viewModel.BlockName ?? DefaultBlockName;

    var boolAttributes = viewModel.BuildAttributes(new Dictionary<string, object>
    {
    { "class", "form-control textbox " + DefaultBlockName + "__checkbox" }
    });

    var labelAttributes = new Dictionary<string, object>
    {
    { "class", "editorLabel " + DefaultBlockName + "__label" }
    };

    if (viewModel.Required)
    {
        boolAttributes["required"] = true;
        boolAttributes["class"] = boolAttributes["class"] + " required";
        labelAttributes["class"] = labelAttributes["class"] + " required";
    }

    if (!string.IsNullOrEmpty(viewModel.Placeholder))
    {
        boolAttributes["placeholder"] = viewModel.Placeholder;
    }

    var yesBool = boolAttributes.ToDictionary(k => k.Key, k => k.Value);
    yesBool["id"] = BlockName + "__yes";

    var onChangedSelectorId = viewModel.Id ?? viewModel.Name.HtmlClassify();
}

<div id="@onChangedSelectorId" class="editor editorField form-group @DefaultBlockName @BlockName js-@viewModel.Name.HtmlClassify()">
    @if (!string.IsNullOrEmpty(viewModel.Label))
    {
        @Html.Label(viewModel.Name, viewModel.Label, labelAttributes)
    }
    <div class="js-@(BlockName)__radioButtons">
        <label>
            @Html.RadioButton(viewModel.Name, value, value, yesBool) @T("Yes")
        </label>

        <label>
            @Html.RadioButton(viewModel.Name, !value, !value, boolAttributes) @T("No")
        </label>

    </div>
    @if (!string.IsNullOrEmpty(viewModel.Hint))
    {
        <div class="editorHint @(DefaultBlockName)__editorHint">@viewModel.Hint</div>
    }
</div>

<script type="text/javascript">
    ; (function ($) {
        $(function () {
            $("#@onChangedSelectorId .js-@(BlockName)__radioButtons").on("click", function (event) {
                var boolEditorValue = $(this).find("#BoolEditor__yes").is(":checked");

                //debugger;
                $("#@onChangedSelectorId").trigger("change", [boolEditorValue]);
            });

        });
    })(jQuery);
</script>